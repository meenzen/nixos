#!/usr/bin/env bash

set -eo pipefail

source "$(dirname "$0")/lib.sh"

print "=> Starting Update"

print "==> Formatting Code"
alejandra . >/dev/null 2>&1

print "==> Updating Flake"
git add .
nix flake update --verbose

print "==> Rebuilding NixOS"
git add .
sudo nixos-rebuild switch --upgrade --verbose --flake . $@
