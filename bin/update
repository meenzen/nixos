#!/usr/bin/env bash

set -eo pipefail

source "$(dirname "$0")/lib.sh"

print_start "Updating"

print_status "Formatting Code"
alejandra . >/dev/null 2>&1

print_status "Updating Flake"
git add .
nix flake update --verbose

print_status "Rebuilding NixOS"
git add .
sudo nixos-rebuild switch --upgrade --verbose --flake . $@
